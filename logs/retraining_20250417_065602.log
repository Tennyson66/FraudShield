2025-04-17 06:56:07,294 - INFO - FraudShield AI - Model Retraining
2025-04-17 06:56:07,294 - INFO - =================================
2025-04-17 06:56:07,294 - INFO - Loading feedback data...
2025-04-17 06:56:07,376 - INFO - Preparing training data...
2025-04-17 06:56:07,577 - INFO - Class distribution - Fraud: 1.70%, Legitimate: 98.30%
2025-04-17 06:56:07,577 - INFO - Retraining models...
2025-04-17 06:56:07,584 - INFO - Performing hyperparameter tuning for Random Forest...
2025-04-17 06:56:59,840 - INFO - Best parameters: {'max_depth': None, 'min_samples_leaf': 2, 'min_samples_split': 5, 'n_estimators': 50}
2025-04-17 06:56:59,840 - INFO - Training supervised model (Random Forest)...
2025-04-17 06:57:00,304 - INFO - 
Random Forest Performance:
C:\Users\dhara\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\metrics\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
C:\Users\dhara\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\metrics\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
C:\Users\dhara\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\metrics\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-04-17 06:57:00,353 - INFO -               precision    recall  f1-score   support

           0       0.98      1.00      0.99       197
           1       0.00      0.00      0.00         3

    accuracy                           0.98       200
   macro avg       0.49      0.50      0.50       200
weighted avg       0.97      0.98      0.98       200

2025-04-17 06:57:00,358 - INFO - AUC-ROC: 0.3706
2025-04-17 06:57:00,383 - INFO - 
Top 10 Feature Importances:
2025-04-17 06:57:00,383 - INFO -      feature  importance
1  feature_1    0.569408
7  feature_7    0.373895
5  feature_5    0.054508
4  feature_4    0.001044
3  feature_3    0.000835
9  feature_9    0.000220
2  feature_2    0.000089
0  feature_0    0.000000
6  feature_6    0.000000
8  feature_8    0.000000
2025-04-17 06:57:00,413 - INFO - 
Training anomaly detection model (Isolation Forest)...
Fitting 3 folds for each of 108 candidates, totalling 324 fits
Traceback (most recent call last):
  File "e:\fraudshield\retraining\retrain.py", line 288, in <module>
    main()
  File "e:\fraudshield\retraining\retrain.py", line 278, in main
    compare_model_performance(old_supervised, rf_model, X_test, y_test)
  File "e:\fraudshield\retraining\retrain.py", line 93, in compare_model_performance
    old_pred_proba = old_model.predict_proba(X_test)[:, 1]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dhara\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\ensemble\_forest.py", line 946, in predict_proba
    X = self._validate_X_predict(X)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dhara\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\ensemble\_forest.py", line 638, in _validate_X_predict
    X = validate_data(
        ^^^^^^^^^^^^^^
  File "C:\Users\dhara\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\utils\validation.py", line 2965, in validate_data
    _check_n_features(_estimator, X, reset=reset)
  File "C:\Users\dhara\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\sklearn\utils\validation.py", line 2829, in _check_n_features
    raise ValueError(
ValueError: X has 10 features, but RandomForestClassifier is expecting 5 features as input.
